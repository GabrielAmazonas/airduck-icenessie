{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.4", "generated_at": "2026-01-24T01:00:33.683068Z", "invocation_id": "10dfb17c-5783-4b54-893d-0df7f5a9e40f", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T01:00:33.542265Z", "completed_at": "2026-01-24T01:00:33.570808Z"}, {"name": "execute", "started_at": "2026-01-24T01:00:33.572272Z", "completed_at": "2026-01-24T01:00:33.572287Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.034850358963012695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airduck_transforms.silver_documents", "compiled": true, "compiled_code": "\n\n/*\n * Silver Layer: Deduplicated and Cleaned Documents\n * ================================================\n * - Removes duplicate content via SHA256 hash\n * - Filters by content length\n * - Parses metadata from JSON string\n */\n\nWITH raw AS (\n    SELECT \n        id,\n        content,\n        source,\n        raw_metadata as metadata,\n        ingested_at,\n        -- Deduplication hash (case-insensitive, trimmed)\n        TO_HEX(SHA256(TO_UTF8(LOWER(TRIM(content))))) as content_hash\n    FROM \"iceberg\".\"bronze\".\"raw_documents\"\n    \n    WHERE ingested_at > (SELECT COALESCE(MAX(processed_at), TIMESTAMP '1970-01-01') FROM \"iceberg\".\"silver_silver\".\"silver_documents\")\n    \n),\n\ndeduplicated AS (\n    SELECT \n        *,\n        ROW_NUMBER() OVER (\n            PARTITION BY content_hash \n            ORDER BY ingested_at DESC\n        ) as rn\n    FROM raw\n)\n\nSELECT \n    id,\n    content,\n    content_hash,\n    source,\n    metadata,\n    CURRENT_TIMESTAMP as processed_at\nFROM deduplicated\nWHERE rn = 1\n  AND LENGTH(content) >= 50\n  AND LENGTH(content) <= 10000", "relation_name": "\"iceberg\".\"silver_silver\".\"silver_documents\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T01:00:33.554545Z", "completed_at": "2026-01-24T01:00:33.571884Z"}, {"name": "execute", "started_at": "2026-01-24T01:00:33.574610Z", "completed_at": "2026-01-24T01:00:33.574619Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03792715072631836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.source_not_null_bronze_raw_documents_content.aea0bd8ad8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect content\nfrom \"iceberg\".\"bronze\".\"raw_documents\"\nwhere content is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T01:00:33.564503Z", "completed_at": "2026-01-24T01:00:33.572672Z"}, {"name": "execute", "started_at": "2026-01-24T01:00:33.575659Z", "completed_at": "2026-01-24T01:00:33.575668Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03821587562561035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.source_not_null_bronze_raw_documents_id.0670700bf5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"iceberg\".\"bronze\".\"raw_documents\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T01:00:33.583546Z", "completed_at": "2026-01-24T01:00:33.596399Z"}, {"name": "execute", "started_at": "2026-01-24T01:00:33.603470Z", "completed_at": "2026-01-24T01:00:33.603484Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.026523828506469727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airduck_transforms.gold_documents", "compiled": true, "compiled_code": "\n\n/*\n * Gold Layer: Vector-Ready Documents\n * ===================================\n * - Chunks long documents into smaller pieces\n * - Computes quality scores for filtering\n * - Ready for embedding generation by DuckDB/FastAPI\n */\n\nWITH silver AS (\n    SELECT * FROM \"iceberg\".\"silver_silver\".\"silver_documents\"\n),\n\n-- Generate chunk indices for documents\nchunk_indices AS (\n    SELECT \n        id as original_id,\n        content,\n        source,\n        content_hash,\n        metadata,\n        processed_at,\n        CAST(CEIL(LENGTH(content) / 1000.0) AS INTEGER) as num_chunks\n    FROM silver\n    WHERE LENGTH(content) > 0\n),\n\n-- Expand into chunks (simplified chunking - production should use overlap)\nchunked AS (\n    SELECT \n        original_id || '-' || CAST(chunk_idx AS VARCHAR) as id,\n        CASE \n            WHEN num_chunks = 1 THEN content\n            ELSE SUBSTR(\n                content, \n                (chunk_idx - 1) * 1000 + 1, \n                1000\n            )\n        END as content,\n        chunk_idx as chunk_index,\n        num_chunks as total_chunks,\n        metadata,\n        source,\n        content_hash as original_content_hash,\n        processed_at\n    FROM chunk_indices\n    CROSS JOIN UNNEST(SEQUENCE(1, GREATEST(1, num_chunks))) AS t(chunk_idx)\n),\n\n-- Compute quality scores\nscored AS (\n    SELECT \n        *,\n        -- Quality score based on content characteristics (0.0 - 1.0)\n        (\n            -- Length score (0.0 - 0.3)\n            CASE \n                WHEN LENGTH(content) > 200 THEN 0.3\n                WHEN LENGTH(content) > 100 THEN 0.2\n                ELSE 0.1 \n            END +\n            -- Has proper case (0.0 - 0.2)\n            CASE WHEN REGEXP_LIKE(content, '[A-Z]') THEN 0.2 ELSE 0.0 END +\n            -- Word count (0.0 - 0.3)\n            CASE \n                WHEN CARDINALITY(SPLIT(content, ' ')) > 20 THEN 0.3\n                WHEN CARDINALITY(SPLIT(content, ' ')) > 10 THEN 0.2\n                ELSE 0.1 \n            END +\n            -- Not blank (0.0 - 0.2)\n            CASE WHEN NOT REGEXP_LIKE(content, '^\\s*$') THEN 0.2 ELSE 0.0 END\n        ) as quality_score\n    FROM chunked\n    WHERE LENGTH(TRIM(content)) > 0\n)\n\nSELECT \n    id,\n    content,\n    chunk_index,\n    total_chunks,\n    metadata,\n    source,\n    original_content_hash,\n    -- Embedding placeholder (computed by DuckDB/FastAPI later)\n    CAST(NULL AS ARRAY(REAL)) as embedding,\n    quality_score,\n    CURRENT_TIMESTAMP as ready_at\nFROM scored\nWHERE quality_score >= 0.5", "relation_name": "\"iceberg\".\"silver_gold\".\"gold_documents\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T01:00:33.587674Z", "completed_at": "2026-01-24T01:00:33.596938Z"}, {"name": "execute", "started_at": "2026-01-24T01:00:33.603905Z", "completed_at": "2026-01-24T01:00:33.603914Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02663397789001465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_silver_documents_content.3649e86479", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect content\nfrom \"iceberg\".\"silver_silver\".\"silver_documents\"\nwhere content is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T01:00:33.592845Z", "completed_at": "2026-01-24T01:00:33.602951Z"}, {"name": "execute", "started_at": "2026-01-24T01:00:33.607267Z", "completed_at": "2026-01-24T01:00:33.607274Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.027586698532104492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_silver_documents_content_hash.3c28173e86", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect content_hash\nfrom \"iceberg\".\"silver_silver\".\"silver_documents\"\nwhere content_hash is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T01:00:33.597437Z", "completed_at": "2026-01-24T01:00:33.604276Z"}, {"name": "execute", "started_at": "2026-01-24T01:00:33.609252Z", "completed_at": "2026-01-24T01:00:33.609262Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02913045883178711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_silver_documents_id.9dc9aee5ec", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"iceberg\".\"silver_silver\".\"silver_documents\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T01:00:33.618827Z", "completed_at": "2026-01-24T01:00:33.625147Z"}, {"name": "execute", "started_at": "2026-01-24T01:00:33.635201Z", "completed_at": "2026-01-24T01:00:33.635212Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026177406311035156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.unique_silver_documents_content_hash.75cf9eb00f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    content_hash as unique_field,\n    count(*) as n_records\n\nfrom \"iceberg\".\"silver_silver\".\"silver_documents\"\nwhere content_hash is not null\ngroup by content_hash\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T01:00:33.614820Z", "completed_at": "2026-01-24T01:00:33.625527Z"}, {"name": "execute", "started_at": "2026-01-24T01:00:33.636455Z", "completed_at": "2026-01-24T01:00:33.636461Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02856302261352539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_silver_documents_processed_at.1b5086d7fd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect processed_at\nfrom \"iceberg\".\"silver_silver\".\"silver_documents\"\nwhere processed_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T01:00:33.625924Z", "completed_at": "2026-01-24T01:00:33.635665Z"}, {"name": "execute", "started_at": "2026-01-24T01:00:33.640290Z", "completed_at": "2026-01-24T01:00:33.640295Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02877044677734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_gold_documents_chunk_index.3d9f04eae4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect chunk_index\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere chunk_index is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T01:00:33.630845Z", "completed_at": "2026-01-24T01:00:33.636070Z"}, {"name": "execute", "started_at": "2026-01-24T01:00:33.640782Z", "completed_at": "2026-01-24T01:00:33.640786Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02036118507385254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_gold_documents_content.3f4a9b02a4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect content\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere content is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T01:00:33.646761Z", "completed_at": "2026-01-24T01:00:33.656528Z"}, {"name": "execute", "started_at": "2026-01-24T01:00:33.667467Z", "completed_at": "2026-01-24T01:00:33.667476Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027422189712524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_gold_documents_id.2a9bd59688", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T01:00:33.651998Z", "completed_at": "2026-01-24T01:00:33.662018Z"}, {"name": "execute", "started_at": "2026-01-24T01:00:33.668238Z", "completed_at": "2026-01-24T01:00:33.668242Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.026118993759155273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_gold_documents_quality_score.601b556ddc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quality_score\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere quality_score is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T01:00:33.657078Z", "completed_at": "2026-01-24T01:00:33.667058Z"}, {"name": "execute", "started_at": "2026-01-24T01:00:33.671035Z", "completed_at": "2026-01-24T01:00:33.671040Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022025346755981445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_gold_documents_ready_at.195ae128fe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ready_at\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere ready_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T01:00:33.662561Z", "completed_at": "2026-01-24T01:00:33.667858Z"}, {"name": "execute", "started_at": "2026-01-24T01:00:33.672023Z", "completed_at": "2026-01-24T01:00:33.672027Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.022487401962280273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_gold_documents_total_chunks.cdea23d221", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_chunks\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere total_chunks is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-24T01:00:33.675123Z", "completed_at": "2026-01-24T01:00:33.678963Z"}, {"name": "execute", "started_at": "2026-01-24T01:00:33.679739Z", "completed_at": "2026-01-24T01:00:33.679747Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007086515426635742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.unique_gold_documents_id.3ce821f85f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 0.30750584602355957, "args": {"indirect_selection": "eager", "log_level_file": "debug", "empty_catalog": false, "select": [], "which": "generate", "compile": true, "cache_selected_only": false, "warn_error_options": {"include": [], "exclude": []}, "send_anonymous_usage_stats": true, "populate_cache": true, "strict_mode": false, "print": true, "favor_state": false, "printer_width": 80, "log_file_max_bytes": 10485760, "enable_legacy_logger": false, "invocation_command": "dbt docs generate --profiles-dir /opt/airflow/dbt --target dev", "log_level": "info", "profiles_dir": "/opt/airflow/dbt", "static_parser": true, "target": "dev", "version_check": true, "quiet": false, "write_json": true, "show_resource_report": false, "log_format_file": "debug", "partial_parse_file_diff": true, "log_path": "/opt/airflow/dbt/logs", "use_colors": true, "project_dir": "/opt/airflow/dbt", "introspect": true, "vars": {}, "log_format": "default", "static": false, "macro_debugging": false, "use_colors_file": true, "defer": false, "exclude": [], "partial_parse": true}}