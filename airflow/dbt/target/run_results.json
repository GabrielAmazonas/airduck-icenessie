{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.4", "generated_at": "2026-01-29T01:00:30.326228Z", "invocation_id": "fce8f58f-6a63-4fea-ba12-9725fc7f8538", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T01:00:30.216586Z", "completed_at": "2026-01-29T01:00:30.232492Z"}, {"name": "execute", "started_at": "2026-01-29T01:00:30.234840Z", "completed_at": "2026-01-29T01:00:30.234851Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022647857666015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airduck_transforms.silver_documents", "compiled": true, "compiled_code": "\n\n/*\n * Silver Layer: Deduplicated and Cleaned Documents\n * ================================================\n * - Removes duplicate content via SHA256 hash\n * - Filters by content length\n * - Parses metadata from JSON string\n */\n\nWITH raw AS (\n    SELECT \n        id,\n        content,\n        source,\n        raw_metadata as metadata,\n        ingested_at,\n        -- Deduplication hash (case-insensitive, trimmed)\n        TO_HEX(SHA256(TO_UTF8(LOWER(TRIM(content))))) as content_hash\n    FROM \"iceberg\".\"bronze\".\"raw_documents\"\n    \n    \n    \n),\n\ndeduplicated AS (\n    SELECT \n        *,\n        ROW_NUMBER() OVER (\n            PARTITION BY content_hash \n            ORDER BY ingested_at DESC\n        ) as rn\n    FROM raw\n)\n\nSELECT \n    id,\n    content,\n    content_hash,\n    source,\n    metadata,\n    CURRENT_TIMESTAMP as processed_at\nFROM deduplicated\nWHERE rn = 1\n  AND LENGTH(content) >= 50\n  AND LENGTH(content) <= 10000", "relation_name": "\"iceberg\".\"silver_silver\".\"silver_documents\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T01:00:30.219859Z", "completed_at": "2026-01-29T01:00:30.232907Z"}, {"name": "execute", "started_at": "2026-01-29T01:00:30.235230Z", "completed_at": "2026-01-29T01:00:30.235235Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022754192352294922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.source_not_null_bronze_raw_documents_content.aea0bd8ad8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect content\nfrom \"iceberg\".\"bronze\".\"raw_documents\"\nwhere content is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T01:00:30.228196Z", "completed_at": "2026-01-29T01:00:30.233365Z"}, {"name": "execute", "started_at": "2026-01-29T01:00:30.235617Z", "completed_at": "2026-01-29T01:00:30.235624Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.022777318954467773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.source_not_null_bronze_raw_documents_id.0670700bf5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"iceberg\".\"bronze\".\"raw_documents\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T01:00:30.243804Z", "completed_at": "2026-01-29T01:00:30.256276Z"}, {"name": "execute", "started_at": "2026-01-29T01:00:30.258818Z", "completed_at": "2026-01-29T01:00:30.258828Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020624876022338867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airduck_transforms.gold_documents", "compiled": true, "compiled_code": "\n\n/*\n * Gold Layer: Vector-Ready Documents\n * ===================================\n * - Chunks long documents into smaller pieces\n * - Computes quality scores for filtering\n * - Ready for embedding generation by DuckDB/FastAPI\n */\n\nWITH silver AS (\n    SELECT * FROM \"iceberg\".\"silver_silver\".\"silver_documents\"\n),\n\n-- Generate chunk indices for documents\nchunk_indices AS (\n    SELECT \n        id as original_id,\n        content,\n        source,\n        content_hash,\n        metadata,\n        processed_at,\n        CAST(CEIL(LENGTH(content) / 1000.0) AS INTEGER) as num_chunks\n    FROM silver\n    WHERE LENGTH(content) > 0\n),\n\n-- Expand into chunks (simplified chunking - production should use overlap)\nchunked AS (\n    SELECT \n        original_id || '-' || CAST(chunk_idx AS VARCHAR) as id,\n        CASE \n            WHEN num_chunks = 1 THEN content\n            ELSE SUBSTR(\n                content, \n                (chunk_idx - 1) * 1000 + 1, \n                1000\n            )\n        END as content,\n        chunk_idx as chunk_index,\n        num_chunks as total_chunks,\n        metadata,\n        source,\n        content_hash as original_content_hash,\n        processed_at\n    FROM chunk_indices\n    CROSS JOIN UNNEST(SEQUENCE(1, GREATEST(1, num_chunks))) AS t(chunk_idx)\n),\n\n-- Compute quality scores\nscored AS (\n    SELECT \n        *,\n        -- Quality score based on content characteristics (0.0 - 1.0)\n        (\n            -- Length score (0.0 - 0.3)\n            CASE \n                WHEN LENGTH(content) > 200 THEN 0.3\n                WHEN LENGTH(content) > 100 THEN 0.2\n                ELSE 0.1 \n            END +\n            -- Has proper case (0.0 - 0.2)\n            CASE WHEN REGEXP_LIKE(content, '[A-Z]') THEN 0.2 ELSE 0.0 END +\n            -- Word count (0.0 - 0.3)\n            CASE \n                WHEN CARDINALITY(SPLIT(content, ' ')) > 20 THEN 0.3\n                WHEN CARDINALITY(SPLIT(content, ' ')) > 10 THEN 0.2\n                ELSE 0.1 \n            END +\n            -- Not blank (0.0 - 0.2)\n            CASE WHEN NOT REGEXP_LIKE(content, '^\\s*$') THEN 0.2 ELSE 0.0 END\n        ) as quality_score\n    FROM chunked\n    WHERE LENGTH(TRIM(content)) > 0\n)\n\nSELECT \n    id,\n    content,\n    chunk_index,\n    total_chunks,\n    metadata,\n    source,\n    original_content_hash,\n    -- Embedding placeholder (computed by DuckDB/FastAPI later)\n    CAST(NULL AS ARRAY(REAL)) as embedding,\n    quality_score,\n    CURRENT_TIMESTAMP as ready_at\nFROM scored\nWHERE quality_score >= 0.5", "relation_name": "\"iceberg\".\"silver_gold\".\"gold_documents\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T01:00:30.246755Z", "completed_at": "2026-01-29T01:00:30.256845Z"}, {"name": "execute", "started_at": "2026-01-29T01:00:30.259568Z", "completed_at": "2026-01-29T01:00:30.259574Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.021037817001342773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_silver_documents_content.3649e86479", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect content\nfrom \"iceberg\".\"silver_silver\".\"silver_documents\"\nwhere content is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T01:00:30.250164Z", "completed_at": "2026-01-29T01:00:30.257639Z"}, {"name": "execute", "started_at": "2026-01-29T01:00:30.261054Z", "completed_at": "2026-01-29T01:00:30.261060Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022185802459716797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_silver_documents_content_hash.3c28173e86", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect content_hash\nfrom \"iceberg\".\"silver_silver\".\"silver_documents\"\nwhere content_hash is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T01:00:30.253012Z", "completed_at": "2026-01-29T01:00:30.258319Z"}, {"name": "execute", "started_at": "2026-01-29T01:00:30.262122Z", "completed_at": "2026-01-29T01:00:30.262128Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022714853286743164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_silver_documents_id.9dc9aee5ec", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"iceberg\".\"silver_silver\".\"silver_documents\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T01:00:30.269042Z", "completed_at": "2026-01-29T01:00:30.284651Z"}, {"name": "execute", "started_at": "2026-01-29T01:00:30.287321Z", "completed_at": "2026-01-29T01:00:30.287332Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02397441864013672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_silver_documents_processed_at.1b5086d7fd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect processed_at\nfrom \"iceberg\".\"silver_silver\".\"silver_documents\"\nwhere processed_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T01:00:30.272406Z", "completed_at": "2026-01-29T01:00:30.285108Z"}, {"name": "execute", "started_at": "2026-01-29T01:00:30.288058Z", "completed_at": "2026-01-29T01:00:30.288062Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.023981332778930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.unique_silver_documents_content_hash.75cf9eb00f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    content_hash as unique_field,\n    count(*) as n_records\n\nfrom \"iceberg\".\"silver_silver\".\"silver_documents\"\nwhere content_hash is not null\ngroup by content_hash\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T01:00:30.277121Z", "completed_at": "2026-01-29T01:00:30.286116Z"}, {"name": "execute", "started_at": "2026-01-29T01:00:30.289463Z", "completed_at": "2026-01-29T01:00:30.289468Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024205446243286133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_gold_documents_chunk_index.3d9f04eae4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect chunk_index\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere chunk_index is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T01:00:30.281215Z", "completed_at": "2026-01-29T01:00:30.286869Z"}, {"name": "execute", "started_at": "2026-01-29T01:00:30.290696Z", "completed_at": "2026-01-29T01:00:30.290700Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02450418472290039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_gold_documents_content.3f4a9b02a4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect content\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere content is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T01:00:30.297031Z", "completed_at": "2026-01-29T01:00:30.306606Z"}, {"name": "execute", "started_at": "2026-01-29T01:00:30.311859Z", "completed_at": "2026-01-29T01:00:30.311863Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020102739334106445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_gold_documents_id.2a9bd59688", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T01:00:30.300434Z", "completed_at": "2026-01-29T01:00:30.310129Z"}, {"name": "execute", "started_at": "2026-01-29T01:00:30.313038Z", "completed_at": "2026-01-29T01:00:30.313042Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.020737886428833008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_gold_documents_quality_score.601b556ddc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quality_score\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere quality_score is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T01:00:30.303712Z", "completed_at": "2026-01-29T01:00:30.311077Z"}, {"name": "execute", "started_at": "2026-01-29T01:00:30.314472Z", "completed_at": "2026-01-29T01:00:30.314476Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02141571044921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_gold_documents_ready_at.195ae128fe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ready_at\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere ready_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T01:00:30.307061Z", "completed_at": "2026-01-29T01:00:30.312234Z"}, {"name": "execute", "started_at": "2026-01-29T01:00:30.316465Z", "completed_at": "2026-01-29T01:00:30.316470Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0219571590423584, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_gold_documents_total_chunks.cdea23d221", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_chunks\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere total_chunks is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-29T01:00:30.319360Z", "completed_at": "2026-01-29T01:00:30.322368Z"}, {"name": "execute", "started_at": "2026-01-29T01:00:30.323061Z", "completed_at": "2026-01-29T01:00:30.323065Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005948781967163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.unique_gold_documents_id.3ce821f85f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 0.1891801357269287, "args": {"log_level_file": "debug", "use_colors": true, "warn_error_options": {"include": [], "exclude": []}, "project_dir": "/opt/airflow/dbt", "log_format_file": "debug", "strict_mode": false, "vars": {}, "log_file_max_bytes": 10485760, "partial_parse_file_diff": true, "print": true, "static": false, "macro_debugging": false, "show_resource_report": false, "favor_state": false, "log_format": "default", "invocation_command": "dbt docs generate --profiles-dir /opt/airflow/dbt --target dev", "select": [], "profiles_dir": "/opt/airflow/dbt", "populate_cache": true, "empty_catalog": false, "indirect_selection": "eager", "quiet": false, "write_json": true, "use_colors_file": true, "introspect": true, "log_path": "/opt/airflow/dbt/logs", "static_parser": true, "enable_legacy_logger": false, "which": "generate", "partial_parse": true, "log_level": "info", "exclude": [], "printer_width": 80, "compile": true, "send_anonymous_usage_stats": true, "target": "dev", "version_check": true, "defer": false, "cache_selected_only": false}}