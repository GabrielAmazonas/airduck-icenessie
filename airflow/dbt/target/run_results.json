{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.4", "generated_at": "2026-01-28T19:43:53.367180Z", "invocation_id": "f7bcff5d-3ebf-4763-afc9-28c3b1de61d0", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-28T19:43:53.252974Z", "completed_at": "2026-01-28T19:43:53.270498Z"}, {"name": "execute", "started_at": "2026-01-28T19:43:53.272596Z", "completed_at": "2026-01-28T19:43:53.272609Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023917436599731445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airduck_transforms.silver_documents", "compiled": true, "compiled_code": "\n\n/*\n * Silver Layer: Deduplicated and Cleaned Documents\n * ================================================\n * - Removes duplicate content via SHA256 hash\n * - Filters by content length\n * - Parses metadata from JSON string\n */\n\nWITH raw AS (\n    SELECT \n        id,\n        content,\n        source,\n        raw_metadata as metadata,\n        ingested_at,\n        -- Deduplication hash (case-insensitive, trimmed)\n        TO_HEX(SHA256(TO_UTF8(LOWER(TRIM(content))))) as content_hash\n    FROM \"iceberg\".\"bronze\".\"raw_documents\"\n    \n    \n    \n),\n\ndeduplicated AS (\n    SELECT \n        *,\n        ROW_NUMBER() OVER (\n            PARTITION BY content_hash \n            ORDER BY ingested_at DESC\n        ) as rn\n    FROM raw\n)\n\nSELECT \n    id,\n    content,\n    content_hash,\n    source,\n    metadata,\n    CURRENT_TIMESTAMP as processed_at\nFROM deduplicated\nWHERE rn = 1\n  AND LENGTH(content) >= 50\n  AND LENGTH(content) <= 10000", "relation_name": "\"iceberg\".\"silver_silver\".\"silver_documents\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-28T19:43:53.256522Z", "completed_at": "2026-01-28T19:43:53.271090Z"}, {"name": "execute", "started_at": "2026-01-28T19:43:53.273313Z", "completed_at": "2026-01-28T19:43:53.273319Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024330854415893555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.source_not_null_bronze_raw_documents_content.aea0bd8ad8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect content\nfrom \"iceberg\".\"bronze\".\"raw_documents\"\nwhere content is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-28T19:43:53.265408Z", "completed_at": "2026-01-28T19:43:53.271837Z"}, {"name": "execute", "started_at": "2026-01-28T19:43:53.274418Z", "completed_at": "2026-01-28T19:43:53.274423Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.025302410125732422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.source_not_null_bronze_raw_documents_id.0670700bf5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"iceberg\".\"bronze\".\"raw_documents\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-28T19:43:53.282135Z", "completed_at": "2026-01-28T19:43:53.295842Z"}, {"name": "execute", "started_at": "2026-01-28T19:43:53.298942Z", "completed_at": "2026-01-28T19:43:53.298955Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02313709259033203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airduck_transforms.gold_documents", "compiled": true, "compiled_code": "\n\n/*\n * Gold Layer: Vector-Ready Documents\n * ===================================\n * - Chunks long documents into smaller pieces\n * - Computes quality scores for filtering\n * - Ready for embedding generation by DuckDB/FastAPI\n */\n\nWITH silver AS (\n    SELECT * FROM \"iceberg\".\"silver_silver\".\"silver_documents\"\n),\n\n-- Generate chunk indices for documents\nchunk_indices AS (\n    SELECT \n        id as original_id,\n        content,\n        source,\n        content_hash,\n        metadata,\n        processed_at,\n        CAST(CEIL(LENGTH(content) / 1000.0) AS INTEGER) as num_chunks\n    FROM silver\n    WHERE LENGTH(content) > 0\n),\n\n-- Expand into chunks (simplified chunking - production should use overlap)\nchunked AS (\n    SELECT \n        original_id || '-' || CAST(chunk_idx AS VARCHAR) as id,\n        CASE \n            WHEN num_chunks = 1 THEN content\n            ELSE SUBSTR(\n                content, \n                (chunk_idx - 1) * 1000 + 1, \n                1000\n            )\n        END as content,\n        chunk_idx as chunk_index,\n        num_chunks as total_chunks,\n        metadata,\n        source,\n        content_hash as original_content_hash,\n        processed_at\n    FROM chunk_indices\n    CROSS JOIN UNNEST(SEQUENCE(1, GREATEST(1, num_chunks))) AS t(chunk_idx)\n),\n\n-- Compute quality scores\nscored AS (\n    SELECT \n        *,\n        -- Quality score based on content characteristics (0.0 - 1.0)\n        (\n            -- Length score (0.0 - 0.3)\n            CASE \n                WHEN LENGTH(content) > 200 THEN 0.3\n                WHEN LENGTH(content) > 100 THEN 0.2\n                ELSE 0.1 \n            END +\n            -- Has proper case (0.0 - 0.2)\n            CASE WHEN REGEXP_LIKE(content, '[A-Z]') THEN 0.2 ELSE 0.0 END +\n            -- Word count (0.0 - 0.3)\n            CASE \n                WHEN CARDINALITY(SPLIT(content, ' ')) > 20 THEN 0.3\n                WHEN CARDINALITY(SPLIT(content, ' ')) > 10 THEN 0.2\n                ELSE 0.1 \n            END +\n            -- Not blank (0.0 - 0.2)\n            CASE WHEN NOT REGEXP_LIKE(content, '^\\s*$') THEN 0.2 ELSE 0.0 END\n        ) as quality_score\n    FROM chunked\n    WHERE LENGTH(TRIM(content)) > 0\n)\n\nSELECT \n    id,\n    content,\n    chunk_index,\n    total_chunks,\n    metadata,\n    source,\n    original_content_hash,\n    -- Embedding placeholder (computed by DuckDB/FastAPI later)\n    CAST(NULL AS ARRAY(REAL)) as embedding,\n    quality_score,\n    CURRENT_TIMESTAMP as ready_at\nFROM scored\nWHERE quality_score >= 0.5", "relation_name": "\"iceberg\".\"silver_gold\".\"gold_documents\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-28T19:43:53.286170Z", "completed_at": "2026-01-28T19:43:53.296453Z"}, {"name": "execute", "started_at": "2026-01-28T19:43:53.299857Z", "completed_at": "2026-01-28T19:43:53.299863Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023468732833862305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_silver_documents_content.3649e86479", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect content\nfrom \"iceberg\".\"silver_silver\".\"silver_documents\"\nwhere content is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-28T19:43:53.289340Z", "completed_at": "2026-01-28T19:43:53.296882Z"}, {"name": "execute", "started_at": "2026-01-28T19:43:53.300233Z", "completed_at": "2026-01-28T19:43:53.300238Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.023717164993286133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_silver_documents_content_hash.3c28173e86", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect content_hash\nfrom \"iceberg\".\"silver_silver\".\"silver_documents\"\nwhere content_hash is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-28T19:43:53.292599Z", "completed_at": "2026-01-28T19:43:53.297786Z"}, {"name": "execute", "started_at": "2026-01-28T19:43:53.301777Z", "completed_at": "2026-01-28T19:43:53.301783Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02385115623474121, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_silver_documents_id.9dc9aee5ec", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"iceberg\".\"silver_silver\".\"silver_documents\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-28T19:43:53.309727Z", "completed_at": "2026-01-28T19:43:53.325150Z"}, {"name": "execute", "started_at": "2026-01-28T19:43:53.327905Z", "completed_at": "2026-01-28T19:43:53.327915Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02346062660217285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_silver_documents_processed_at.1b5086d7fd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect processed_at\nfrom \"iceberg\".\"silver_silver\".\"silver_documents\"\nwhere processed_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-28T19:43:53.313489Z", "completed_at": "2026-01-28T19:43:53.325794Z"}, {"name": "execute", "started_at": "2026-01-28T19:43:53.328974Z", "completed_at": "2026-01-28T19:43:53.328978Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024075031280517578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.unique_silver_documents_content_hash.75cf9eb00f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    content_hash as unique_field,\n    count(*) as n_records\n\nfrom \"iceberg\".\"silver_silver\".\"silver_documents\"\nwhere content_hash is not null\ngroup by content_hash\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-28T19:43:53.317859Z", "completed_at": "2026-01-28T19:43:53.326714Z"}, {"name": "execute", "started_at": "2026-01-28T19:43:53.330053Z", "completed_at": "2026-01-28T19:43:53.330057Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02456378936767578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_gold_documents_chunk_index.3d9f04eae4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect chunk_index\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere chunk_index is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-28T19:43:53.322163Z", "completed_at": "2026-01-28T19:43:53.327110Z"}, {"name": "execute", "started_at": "2026-01-28T19:43:53.330439Z", "completed_at": "2026-01-28T19:43:53.330444Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02440500259399414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_gold_documents_content.3f4a9b02a4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect content\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere content is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-28T19:43:53.337388Z", "completed_at": "2026-01-28T19:43:53.350228Z"}, {"name": "execute", "started_at": "2026-01-28T19:43:53.353329Z", "completed_at": "2026-01-28T19:43:53.353336Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.021635055541992188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_gold_documents_id.2a9bd59688", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-28T19:43:53.341071Z", "completed_at": "2026-01-28T19:43:53.350866Z"}, {"name": "execute", "started_at": "2026-01-28T19:43:53.353883Z", "completed_at": "2026-01-28T19:43:53.353887Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.021069765090942383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_gold_documents_quality_score.601b556ddc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quality_score\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere quality_score is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-28T19:43:53.344085Z", "completed_at": "2026-01-28T19:43:53.351437Z"}, {"name": "execute", "started_at": "2026-01-28T19:43:53.354675Z", "completed_at": "2026-01-28T19:43:53.354680Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021329402923583984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_gold_documents_ready_at.195ae128fe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ready_at\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere ready_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-28T19:43:53.347047Z", "completed_at": "2026-01-28T19:43:53.352490Z"}, {"name": "execute", "started_at": "2026-01-28T19:43:53.356665Z", "completed_at": "2026-01-28T19:43:53.356669Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.022120237350463867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.not_null_gold_documents_total_chunks.cdea23d221", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_chunks\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere total_chunks is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-28T19:43:53.359988Z", "completed_at": "2026-01-28T19:43:53.363160Z"}, {"name": "execute", "started_at": "2026-01-28T19:43:53.363885Z", "completed_at": "2026-01-28T19:43:53.363890Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005337238311767578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airduck_transforms.unique_gold_documents_id.3ce821f85f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"iceberg\".\"silver_gold\".\"gold_documents\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 0.19826602935791016, "args": {"log_format_file": "debug", "log_path": "/opt/airflow/dbt/logs", "log_level_file": "debug", "defer": false, "send_anonymous_usage_stats": true, "invocation_command": "dbt docs generate --profiles-dir /opt/airflow/dbt --target dev", "log_file_max_bytes": 10485760, "vars": {}, "select": [], "version_check": true, "static_parser": true, "log_level": "info", "profiles_dir": "/opt/airflow/dbt", "exclude": [], "partial_parse": true, "printer_width": 80, "target": "dev", "strict_mode": false, "use_colors_file": true, "write_json": true, "macro_debugging": false, "populate_cache": true, "print": true, "compile": true, "use_colors": true, "warn_error_options": {"include": [], "exclude": []}, "quiet": false, "project_dir": "/opt/airflow/dbt", "indirect_selection": "eager", "cache_selected_only": false, "partial_parse_file_diff": true, "static": false, "introspect": true, "enable_legacy_logger": false, "log_format": "default", "show_resource_report": false, "which": "generate", "empty_catalog": false, "favor_state": false}}